% \documentclass{article}
% \usepackage[ruled, vlined, linesnumbered]{algorithm2e}
% \usepackage{amsmath}
% \usepackage{mhchem}
% \usepackage{xcolor}
% \usepackage{amssymb}

% \begin{document}
\begin{figure}
    % \removelatexerror    
       \begin{algorithm*}[H]
       \SetAlgoLined
       \caption{Pauli Strings Simplification in BSF}
       \label{algo:simplification}
       \SetKwInOut{Input}{Input}
       \SetKwInOut{Output}{Output}
       \SetKwBlock{Assumption}{Assumption}{}
   
       % \Input{Pauli strings with corresponding coefficients (\textit{pls}, \textit{coes})}
       \Input{Pauli strings list \textit{pls}}
       \Output{Reconfigured circuit components list \textit{cfg}}
   
       % \tcp{Following pseudocode only involves transformation on pls while omitting coes WLOG}
       \BlankLine
       \textit{cfg} $ \gets \emptyset $;\quad
       \textit{bsf} $ \gets \textsc{BSF}$(\textit{pls});\quad
       \textit{cliffs\_with\_locals} $\gets \emptyset$\; %\tcp*{Cliffords with local Paulis}
       % $ n \gets $ \textit{bsf}.\textsc{numQubits}()\;
       \While{bsf.\textsc{totalWeight()} $>$ 2}{
           \textit{local\_bsf} $\gets$ \textit{bsf}.\textsc{popLocalPaulis}()\; 
           % $ C \gets \emptyset$;\quad
           % $ B \gets \emptyset$;\quad
   
           $ C \gets \emptyset$ \tcp*{Clifford2Q candidates}
           $ B \gets \emptyset$ \tcp*{Each element of $B$ results from applying each Clifford2Q candidate on \textit{bsf}}
           \textit{costs} $\gets \emptyset$ \tcp*{Cost functions calculated on each element of $B$}
           \For{cg \textbf{in} \textsc{CLIFFORD\_2Q\_SET}}{
               \For{i, j \textbf{in} $ \textsc{combinations}(\textsc{range}(n), 2) $}{
                   \textit{cliff} $\gets$ \textit{cg}.\textsc{on}$ (i, j) $ \tcp*{qubits to act on}
                   \textit{bsf}$'$ $\gets$ \textit{bsf}.\textsc{applyClifford2Q}(\textit{cliff})\;
                   \textit{cost} $\gets$ \textsc{calculateBSFCost}(\textit{bsf}$'$)\;
                   $ C.\textsc{append}$(\textit{cliff})\;
                   $ B.\textsc{append}$(\textit{bsf}$'$)\;
                   \textit{costs}.\textsc{append}(\textit{cost})\;
               }
           }
           % \textit{bsf} $\gets$ \textit{B}[\textit{costs}.\textsc{index}(\textit{min}(\textit{costs}))]\;
           % \textit{cliff} $\gets$ \textit{C}[\textit{costs}.\textsc{index}(\textit{min}(\textit{costs}))]\;
           \textit{bsf} $ \gets \textsc{BSFWithMinCost} (B, \textit{costs}) $\;
           \textit{cliff} $ \gets \textsc{CliffordWithMinCost} (C, \textit{costs}) $\;
           \textit{cliffs\_with\_locals}.\textsc{append}((\textit{cliff}, \textit{local\_bsf}))\;
       }
       \BlankLine
       \textit{cfg}.\textsc{append}(\textit{bsf})\;
       \For{cliff, local\_bsf \textbf{in} cliffs\_with\_locals}{
           \tcp{Clifford2Q operators are added as conjugations, with local Pauli strings removed before each search epoch}
           \textit{cfg}.\textsc{prepend}(\textit{cliff})\;
           \textit{cfg}.\textsc{append}(\textit{local\_bsf})\;
           \textit{cfg}.\textsc{append}(\textit{cliff})\;
       }
   
       \end{algorithm*}
   \end{figure}
% \end{document}
   